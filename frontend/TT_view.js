let timetable = {
	"course": "btechcse",
	"semester": "1",
	"section": "A",
	"schedule": {
		"mon": {
			"08-09": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"09-10": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"10-11": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"11-12": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"12-01": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"01-02": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"02-03": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"03-04": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"04-05": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"05-06": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			}
		},
		"tue": {
			"08-09": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"09-10": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"10-11": {
				"class_id": "2001",
				"subjectcode": "TCS601",
				"slotdata": "TCS601\nLT401"
			},
			"11-12": {
				"class_id": "5006",
				"subjectcode": "XCS601Q",
				"slotdata": "XCS601Q\nCR103"
			},
			"12-01": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"01-02": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"02-03": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"03-04": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"04-05": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"05-06": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			}
		},
		"wed": {
			"08-09": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"09-10": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"10-11": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"11-12": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"12-01": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"01-02": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"02-03": {
				"class_id": "71",
				"subjectcode": "XCS601Q",
				"slotdata": "XCS601Q\nCR103"
			},
			"03-04": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"04-05": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"05-06": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			}
		},
		"thu": {
			"08-09": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"09-10": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"10-11": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"11-12": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"12-01": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"01-02": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"02-03": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"03-04": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"04-05": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"05-06": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			}
		},
		"fri": {
			"08-09": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"09-10": {
				"class_id": "33",
				"subjectcode": "PXCS601",
				"slotdata": "PXCS601\nBosch lab"
			},
			"10-11": {
				"class_id": "33",
				"subjectcode": "PXCS601",
				"slotdata": "PXCS601\nBosch lab"
			},
			"11-12": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"12-01": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"01-02": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"02-03": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"03-04": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"04-05": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"05-06": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			}
		},
		"sat": {
			"08-09": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"09-10": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"10-11": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"11-12": {
				"class_id": "89",
				"subjectcode": "XCS601Q",
				"slotdata": "XCS601Q\nCR106"
			},
			"12-01": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"01-02": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"02-03": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"03-04": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"04-05": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"05-06": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			}
		},
		"sun": {
			"08-09": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"09-10": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"10-11": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"11-12": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"12-01": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"01-02": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"02-03": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"03-04": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"04-05": {
				"class_id": "0",
				"subjectcode": "",
				"slotdata": ""
			},
			"05-06": {
				"class_id": "87",
				"subjectcode": "TCS604",
				"slotdata": "TCS604\nCR105"
			}
		}
	},
	"teacher_subject_data": [
		{
			"subjectcode": "TCS601",
			"teacherid": "2",
			"weekly_hrs": "3",
			"teachername": "DR DEVESH P SINGH",
			"subjectname": "COMPILER DESIGN",
			"theory_practical": "Theory"
		},
		{
			"subjectcode": "PXCS601",
			"teacherid": "21011355",
			"weekly_hrs": "3",
			"teachername": "MS NEELAM",
			"subjectname": "CAREER SKILLS LAB",
			"theory_practical": "Practical"
		},
		{
			"subjectcode": "XCS601Q",
			"teacherid": "10",
			"weekly_hrs": "3",
			"teachername": "MR PA ANAND",
			"subjectname": "CAREER SKILLS QUANT",
			"theory_practical": "Theory"
		},
		{
			"subjectcode": "TCS604",
			"teacherid": "3",
			"weekly_hrs": "3",
			"teachername": "DR SATVIK VATS",
			"subjectname": "COMPUTER NETWORKS I",
			"theory_practical": "Theory"
		}
	]
}

const letmesee2 = (temp_obj) => {
	for (let i = 1; i <= 7; i++) {
		// ======================================== will be used in download optin [ future feature ] ======================================== 
		// document.getElementById("render-course-detail").innerHTML =   "Course : " + document.getElementById("course_option").options[document.getElementById("course_option").selectedIndex].textContent;;
		// document.getElementById("render-semester-detail").innerHTML = "Semester : " + document.getElementById("semester_option").value;
		// document.getElementById("render-section-detail").innerHTML =  "Section : " + document.getElementById("section_option").value;
		// =================================================================================================================================== 
		
		let currrow = document.getElementById("mytable").rows[i].cells[0].innerHTML.toLowerCase();
		let day_row_border_adding = document.getElementById("mytable").rows[i];
		let today = new Date();
		const weekdays = ["sun", "mon", "tue", "wed", "thu", "fri", "sat"];
		let day_slot = weekdays[today.getDay()];
		let hours = today.getHours();
		let houre = hours + 1;
		hours = (hours > 12) ? String(hours - 12).padStart(2, "0") : String(hours).padStart(2, "0");
		houre = (houre > 12) ? String(houre - 12).padStart(2, "0") : String(houre).padStart(2, "0");
		let time_slot = hours + "-" + houre;
		time_slot = (time_slot).toString();

		for (let j = 1; j <= 10; j++) {
			let currcol = document.getElementById("mytable").rows[0].cells[j].innerHTML.toLowerCase();
			if (temp_obj && temp_obj.schedule && temp_obj.schedule[currrow] && temp_obj.schedule[currrow][currcol] && temp_obj.schedule[currrow][currcol].slotdata) {
				document.getElementById("mytable").rows[i].cells[j].setAttribute("class", "text bg-danger  text-white heading-text border-dark border-3");
				document.getElementById("mytable").rows[i].cells[j].innerHTML = temp_obj.schedule[currrow][currcol].slotdata.replace(" ", "<br>");;
			}
			else {
				document.getElementById("mytable").rows[i].cells[j].setAttribute("class", "text bg-primary bg-gradient text-white heading-text border-dark border-3");
				document.getElementById("mytable").rows[i].cells[j].innerHTML = '';
			}

			if (currcol === time_slot && currrow === day_slot && today.getHours()<19) { // color the time and day and period slots 
				day_row_border_adding.cells[0].classList.add("bg-warning");							//dayslot color
				document.getElementById("mytable").rows[0].cells[j].classList.add("bg-warning");	//timeslot color
				document.getElementById("mytable").rows[i].cells[j].classList.add("bg-peela");		// day-time	slot color
			}
		}
	}
};
// letmesee2(temp_obj)

const letmeseeitbaby = () => {
	let course = document.getElementById("course_option").value;
	let semester = document.getElementById("semester_option").value;
	let section = document.getElementById("section_option").value;


	// let queryString = `?course=${course}&semester=${semester}&section=${section}`;  // Constructing the query string
	// console.log("Request URL: http://127.0.0.1:3000/table/get-timetable" + queryString);    // Logging the constructed query string

	// Sending the GET request
	fetch('http://127.0.0.1:3000/table/get-timetable?' + new URLSearchParams({ course: course, semester: semester, section: section }), {
		method: 'GET',
		headers: {
			'Content-Type': 'application/json'
		}
	})
		.then(response => response.json())
		.then(data => {
			timetable = data;        // Do something with the response data here 
			// console.log(data);
			letmesee2(timetable);
			render_tables();
		})
		.catch(error => console.error('Data unavailable:', error));
}
letmeseeitbaby()

document.getElementById('letmesee').addEventListener('click', letmeseeitbaby);

const render_tables = () => {
	// rendering the second table first 
	let localteacher_subject_data = timetable.teacher_subject_data;
	let table = document.getElementById("teacher_table").getElementsByTagName('tbody')[0];
	table.innerHTML = "";
	for (let i = 0; i < localteacher_subject_data.length; i++) {
		const element = localteacher_subject_data[i];

		let newRow = table.insertRow(table.rows.length);

		let cell = newRow.insertCell();
		cell.setAttribute("class", "table-light text border-dark border-3");
		let select = document.createElement('span');
		select.innerText = localteacher_subject_data[i].subjectname;
		cell.appendChild(select);

		cell = newRow.insertCell();
		cell.setAttribute("class", "table-light text border-dark border-3");
		select = document.createElement('span');
		select.innerText = localteacher_subject_data[i].teachername;
		cell.appendChild(select);

		cell = newRow.insertCell();
		cell.setAttribute("class", "table-light text border-dark border-3");
		select = document.createElement('span');
		select.innerText = localteacher_subject_data[i].subjectcode;
		cell.appendChild(select);

		cell = newRow.insertCell();
		cell.setAttribute("class", "table-light text border-dark border-3");
		select = document.createElement('span');
		select.innerText = localteacher_subject_data[i].weekly_hrs;
		cell.appendChild(select);

		cell = newRow.insertCell();
		cell.setAttribute("class", "table-light text border-dark border-3");
		select = document.createElement('span');
		select.innerText = localteacher_subject_data[i].theory_practical;
		cell.appendChild(select);
	}
}

// ======================================== will be used in download optin [ future feature ] ======================================== 
// document.getElementById("download").addEventListener("click", function() {
// 	const element = document.getElementById("ttdiv"); // Get the HTML element to convert to PDF
//     const opt = {
// 		margin: [0,0.5], // Optional - set the margin (in inches)
//         filename: 'timetable.pdf', // Optional - set the filename of the PDF
//         image: { type: 'jpeg', quality: 1 }, // Optional - set image quality
//         html2canvas: { scale: 2 }, // Optional - set the scale for html2canvas
//         jsPDF: { unit: 'in', format: 'a4', orientation: 'landscape' } // Optional - set PDF format and orientation
//     };
	
//     html2pdf().from(element).set(opt).save();
// });
// =================================================================================================================================== 
